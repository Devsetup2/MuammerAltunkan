
<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medici Scan - İlaç Tanıma</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
     :root{--primary-color:#4a6fa5;--secondary-color:#166088;--accent-color:#4fc3f7;--light-color:#f8f9fa;--dark-color:#343a40;--success-color:#28a745;--warning-color:#ffc107;--danger-color:#dc3545}*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
body{background-color:var(--light-color);color:var(--dark-color);line-height:1.6}.container{max-width:1200px;margin:0 auto;padding:20px}
header{background-color:var(--primary-color);color:white;padding:20px 0;text-align:center;border-radius:0 0 10px 10px;box-shadow:0 4px 6px rgba(32,147,241,0.1);margin-bottom:30px}.subtitle{font-size:1.2rem;opacity:0.9}.main-content{display:flex;flex-direction:column;gap:30px}.scan-section,.history-section{background-color:white;border-radius:10px;padding:25px;box-shadow:0 2px 10px rgba(0,0,0,0.1)}.section-title{color:var(--secondary-color);margin-bottom:20px;font-size:1.8rem;border-bottom:2px solid var(--accent-color);padding-bottom:10px}.camera-container{position:relative;width:100%;max-width:500px;margin:0 auto;border:3px dashed var(--primary-color);border-radius:10px;aspect-ratio:1/1;display:flex;justify-content:center;align-items:center;overflow:hidden;background-color:#f1f1f1}
#camera-view{width:100%;height:100%;object-fit:cover;display:none}.camera-placeholder{text-align:center;padding:20px;color:var(--secondary-color)}.camera-icon{font-size:3rem;margin-bottom:15px}.controls{display:flex;justify-content:center;gap:15px;margin-top:20px;flex-wrap:wrap}.btn{padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:1rem;font-weight:600;transition:all 0.3s ease;display:inline-flex;align-items:center;gap:8px}.btn-primary{background-color:var(--primary-color);color:white}.btn-primary:hover{background-color:var(--secondary-color)}.btn-secondary{background-color:var(--light-color);color:var(--dark-color);border:1px solid var(--dark-color)}.btn-secondary:hover{background-color:#e9ecef}.btn-danger{background-color:var(--danger-color);color:white}.btn-danger:hover{background-color:#c82333}
#capture-btn{display:none}.result-container{margin-top:30px;padding:20px;border-radius:8px;background-color:#f8f9fa;border-left:5px solid var(--accent-color);display:none}.result-title{color:var(--secondary-color);margin-bottom:15px}.result-content{line-height:1.8}.loading{display:none;text-align:center;margin:20px 0}.spinner{border:5px solid #f3f3f3;border-top:5px solid var(--primary-color);border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:0 auto}
@keyframes spin{0%{transform:rotate(0deg)}
100%{transform:rotate(360deg)}}.history-list{list-style-type:none}.history-item{background-color:white;border:1px solid #ddd;border-radius:5px;padding:15px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;transition:all 0.3s ease}.history-item:hover{box-shadow:0 2px 8px rgba(0,0,0,0.1);transform:translateY(-2px)}.history-info{flex:1}.history-date{font-size:0.8rem;color:#6c757d;margin-top:5px}.history-actions{display:flex;gap:10px}.no-history{text-align:center;padding:20px;color:#6c757d;font-style:italic}
footer{text-align:center;margin-top:50px;padding:20px;color:#6c757d;font-size:0.9rem}
@media(max-width:768px){h1{font-size:2rem}.subtitle{font-size:1rem}.controls{flex-direction:column;align-items:center}.btn{width:100%;justify-content:center}}   
    </style>
</head>
<body>
    <header><meta name="robots" content="noindex"><meta name="description" content="mediciScan Akıllı İlaç Tarama Uygulaması"><div class=container><h1>Medici Scan<img height=64 src=https://devsetup2.github.io/MuammerAltunkan/deepmind.png width=64></h1><p class=subtitle>Akıllı İlaç Tanıma Uygulaması</div></header><div class=container><main class=main-content><section class=scan-section><h2 class=section-title>İlaç Tarama <span><i class="fa-solid fa-barcode"></i></span></h2><div class=camera-container><video autoplay id=camera-view playsinline></video><div class=camera-placeholder><div class=camera-icon><i class="fa-solid fa-camera"></i></div><p>İlaç kutusunun fotoğrafını çekmek için kamera başlat butonuna basın</div></div><div class=controls><button class="btn btn-primary"id=start-camera-btn><span><i class="fa-solid fa-camera"></i></span> Kamera Başlat</button> <button class="btn btn-primary"id=capture-btn><span>⏺<i class="fa-solid fa-camera"></i></span> Fotoğraf Çek</button> <button class="btn btn-secondary"id=reset-btn><span><i class="fa-brands fa-creative-commons-zero"></i></span> Sıfırla</button></div><div class=loading><div class=spinner></div><p>İlaç bilgileri analiz ediliyor...<span><i class="fa-solid fa-magnifying-glass-chart"></i></span></div><div class=result-container><h3 class=result-title>İlaç Bilgileri</h3><div class=result-content id=result-content></div></div></section><section class=history-section><h2 class=section-title>Tarama Geçmişi <span><i class="fa-solid fa-file-waveform"></i></span></h2><ul class=history-list id=history-list></ul><div class=no-history id=no-history>Henüz tarama geçmişi bulunmamaktadır.</div><div class=controls><button class="btn btn-danger"id=clear-history-btn><span><i class="fa-solid fa-trash"></i></span> Geçmişi Temizle</button></div></section></main></div><footer><div class=container><p>Medici Scan © 2025 - Akıllı İlaç Tanıma Uygulaması - Muammer Altunkan</div></footer>
    <script>
        document.addEventListener('DOMContentLoaded',function(){const startCameraBtn=document.getElementById('start-camera-btn');const captureBtn=document.getElementById('capture-btn');const resetBtn=document.getElementById('reset-btn');const clearHistoryBtn=document.getElementById('clear-history-btn');const cameraView=document.getElementById('camera-view');const cameraPlaceholder=document.querySelector('.camera-placeholder');const resultContainer=document.querySelector('.result-container');const resultContent=document.getElementById('result-content');const loadingElement=document.querySelector('.loading');const historyList=document.getElementById('history-list');const noHistoryElement=document.getElementById('no-history');let stream=null;let currentImageData=null;const GEMINI_API_KEY='AIzaSyCmm3tWlEpuFp2COfBPqUWaSNNxoebWmzo';const GEMINI_API_URL=`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;loadHistory();startCameraBtn.addEventListener('click',startCamera);captureBtn.addEventListener('click',captureImage);resetBtn.addEventListener('click',resetScanner);clearHistoryBtn.addEventListener('click',clearHistory);async function startCamera(){try{stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:'environment',width:{ideal:1280},height:{ideal:720}},audio:!1});cameraView.srcObject=stream;cameraView.style.display='block';cameraPlaceholder.style.display='none';startCameraBtn.style.display='none';captureBtn.style.display='inline-flex';resultContainer.style.display='none'}catch(err){console.error("Kamera hatası:",err);alert("Kamera erişiminde bir hata oluştu. Lütfen kamera iznini kontrol edin.")}}
function captureImage(){if(!stream)return;const canvas=document.createElement('canvas');canvas.width=cameraView.videoWidth;canvas.height=cameraView.videoHeight;const ctx=canvas.getContext('2d');ctx.drawImage(cameraView,0,0,canvas.width,canvas.height);currentImageData=canvas.toDataURL('image/jpeg',0.8);stopCamera();processImage(currentImageData)}
async function processImage(imageData){try{loadingElement.style.display='block';const blob=await fetch(imageData).then(res=>res.blob());const base64data=await new Promise((resolve)=>{const reader=new FileReader();reader.onloadend=()=>resolve(reader.result.split(',')[1]);reader.readAsDataURL(blob)});const prompt={contents:[{parts:[{text:"Bu ilaç kutusunun fotoğrafını analiz ederek aşağıdaki bilgileri Türkçe olarak ver:\n\n"+"1. İlaç adı\n"+"2. Etken madde\n"+"3. Kullanım amacı (hangi hastalık/şikayet için)\n"+"4. Kullanım şekli (dozaj, ne sıklıkla alınmalı)\n"+"5. Olası yan etkiler\n"+"6. Uyarılar (hamilelik, alkol ile kullanım vb.)\n"+"7. Saklama koşulları\n\n"+"Bilgileri maddeler halinde ve anlaşılır bir dille sun. "+"Eğer ilaç tanınamıyorsa, kullanıcıdan daha net bir fotoğraf çekmesini iste."},{inlineData:{mimeType:"image/jpeg",data:base64data}}]}]};const response=await fetch(GEMINI_API_URL,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(prompt)});if(!response.ok){throw new Error(`API hatası: ${response.status}`)}
const data=await response.json();if(data.candidates&&data.candidates[0].content.parts[0].text){const resultText=data.candidates[0].content.parts[0].text;showResult(resultText);saveToHistory(resultText,imageData)}else{throw new Error("Geçerli bir yanıt alınamadı.")}}catch(error){console.error("Analiz hatası:",error);resultContent.innerHTML=`<p style="color: var(--danger-color)">İlaç analiz edilirken bir hata oluştu. Lütfen tekrar deneyin.</p>`;resultContainer.style.display='block'}finally{loadingElement.style.display='none'}}
function showResult(resultText){resultContent.innerHTML=resultText.replace(/\n/g,'<br>');resultContainer.style.display='block'}
function stopCamera(){if(stream){stream.getTracks().forEach(track=>track.stop());stream=null}
cameraView.style.display='none';cameraPlaceholder.style.display='block';startCameraBtn.style.display='inline-flex';captureBtn.style.display='none'}
function resetScanner(){stopCamera();resultContainer.style.display='none';currentImageData=null}
function saveToHistory(resultText,imageData){const history=JSON.parse(localStorage.getItem('mediciScanHistory'))||[];history.unshift({date:new Date().toISOString(),result:resultText,image:imageData});if(history.length>10){history.pop()}
localStorage.setItem('mediciScanHistory',JSON.stringify(history));loadHistory()}
function loadHistory(){const history=JSON.parse(localStorage.getItem('mediciScanHistory'))||[];historyList.innerHTML='';if(history.length===0){noHistoryElement.style.display='block';return}
noHistoryElement.style.display='none';history.forEach((item,index)=>{const li=document.createElement('li');li.className='history-item';const firstLine=item.result.split('\n')[0]||'İlaç Bilgisi';li.innerHTML=`
                        <div class="history-info">
                            <strong>${firstLine}</strong>
                            <div class="history-date">${new Date(item.date).toLocaleString()}</div>
                        </div>
                        <div class="history-actions">
                            <button class="btn btn-secondary view-history-btn" data-index="${index}">Görüntüle</button>
                            <button class="btn btn-danger delete-history-btn" data-index="${index}">Sil</button>
                        </div>
                    `;historyList.appendChild(li)});document.querySelectorAll('.view-history-btn').forEach(btn=>{btn.addEventListener('click',function(){const index=parseInt(this.getAttribute('data-index'));viewHistoryItem(index)})});document.querySelectorAll('.delete-history-btn').forEach(btn=>{btn.addEventListener('click',function(){const index=parseInt(this.getAttribute('data-index'));deleteHistoryItem(index)})})}
function viewHistoryItem(index){const history=JSON.parse(localStorage.getItem('mediciScanHistory'))||[];if(index>=0&&index<history.length){const item=history[index];showResult(item.result);document.querySelector('.scan-section').scrollIntoView({behavior:'smooth'})}}
function deleteHistoryItem(index){const history=JSON.parse(localStorage.getItem('mediciScanHistory'))||[];if(index>=0&&index<history.length){history.splice(index,1);localStorage.setItem('mediciScanHistory',JSON.stringify(history));loadHistory()}}
function clearHistory(){if(confirm('Tüm tarama geçmişini silmek istediğinize emin misiniz?')){localStorage.removeItem('mediciScanHistory');loadHistory()}}})
    </script>
</body>
</html>